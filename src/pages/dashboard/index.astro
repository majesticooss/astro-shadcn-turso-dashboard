---
import Dashboard from "@/components/routes/Dashboard";
import AuthenticatedLayout from "@/layouts/AuthenticatedLayout.astro";
import { userCanAccessResource } from "@/lib/auth";

const user = Astro.locals.user;
if (!user) {
	return Astro.redirect("/login");
}

if (!userCanAccessResource(user, "dashboard")) {
	return Astro.redirect("/unauthorized");
}
---

<AuthenticatedLayout>
	<Dashboard client:load />
</AuthenticatedLayout>
