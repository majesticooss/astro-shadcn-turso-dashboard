---
import SettingsPage from "@/components/routes/Settings";
import AuthenticatedLayout from "@/layouts/AuthenticatedLayout.astro";
import { userCanAccessResource } from "@/lib/auth";

const user = Astro.locals.user;
if (!user) {
	return Astro.redirect("/login");
}

if (!userCanAccessResource(user, Astro.url)) {
	return Astro.redirect("/unauthorized");
}
---

<AuthenticatedLayout>
	<SettingsPage client:load user={user} />
</AuthenticatedLayout>
