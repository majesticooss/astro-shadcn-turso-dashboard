---
import { userCanAccessResource } from "@/lib/auth";

const user = Astro.locals.user;
if (!user) {
	return Astro.redirect("/login");
}

if (!userCanAccessResource(user, "dashboard")) {
	return Astro.redirect("/unauthorized");
}

return Astro.redirect("/dashboard");
---
